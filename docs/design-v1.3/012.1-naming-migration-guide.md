# Naming Convention Migration Reference

**Purpose**: Quick reference for updating existing documentation to v1.1 naming conventions
**Date**: November 14, 2025

---

## Quick Search & Replace Guide

Use these patterns to update existing documentation files:

### 1. Construct Names

```bash
# Find all old construct references
grep -r "erlmd_construct_" docs/

# Replace with cnstr
sed -i 's/erlmd_construct_\([a-z_]*\)/erlmd_cnstr_\1/g' file.md
```

**Manual Review Needed For**:
- `erlmd_construct_partial_*` → `erlmd_cnstr_prtl_*` (requires two replacements)
- `erlmd_construct_html_block` → `erlmd_cnstr_html_flow` (name change)

### 2. Output Modules

```bash
# Find references
grep -r "erlmd_to_html\|erlmd_to_mdast" docs/

# Replace
sed -i 's/erlmd_to_html/erlmd_html/g' file.md
sed -i 's/erlmd_to_mdast/erlmd_ast/g' file.md
```

### 3. Utility Names

```bash
# Character reference
sed -i 's/erlmd_util_character_reference/erlmd_util_char_ref/g' file.md

# Normalize identifier
sed -i 's/erlmd_util_normalize_identifier/erlmd_util_normalize_id/g' file.md
---

## Complete Mapping Table

### Core Framework

| Old Name | New Name | Status |
|----------|----------|--------|
| `erlmd_to_html` | `erlmd_html` | ✅ Changed |
| `erlmd_to_mdast` | `erlmd_ast` | ✅ Changed |
| `erlmd_compiler` | *(removed)* | ❌ Delete |
| `erlmd_parser` | `erlmd_parser` | ✔️ No change |
| `erlmd_tokenizer` | `erlmd_tokenizer` | ✔️ No change |

### Content Dispatchers

| Old Name | New Name | Status |
|----------|----------|--------|
| `erlmd_construct_document` | `erlmd_cnstr_document` | ✅ Changed |
| `erlmd_construct_flow` | `erlmd_cnstr_flow` | ✅ Changed |
| `erlmd_construct_text` | `erlmd_cnstr_text` | ✅ Changed |
| `erlmd_construct_string` | `erlmd_cnstr_string` | ✅ Changed |

### Block Constructs

| Old Name | New Name | Status |
|----------|----------|--------|
| `erlmd_construct_paragraph` | `erlmd_cnstr_paragraph` | ✅ Changed |
| `erlmd_construct_heading_atx` | `erlmd_cnstr_heading_atx` | ✅ Changed |
| `erlmd_construct_heading_setext` | `erlmd_cnstr_heading_setext` | ✅ Changed |
| `erlmd_construct_thematic_break` | `erlmd_cnstr_thematic_break` | ✅ Changed |
| `erlmd_construct_code_fenced` | `erlmd_cnstr_code_fenced` | ✅ Changed |
| `erlmd_construct_code_indented` | `erlmd_cnstr_code_indented` | ✅ Changed |
| `erlmd_construct_html_block` | `erlmd_cnstr_html_flow` | ✅ Changed (name!) |
| `erlmd_construct_block_quote` | `erlmd_cnstr_block_quote` | ✅ Changed |
| `erlmd_construct_list_item` | `erlmd_cnstr_list_item` | ✅ Changed |
| `erlmd_construct_blank_line` | `erlmd_cnstr_blank_line` | ✅ Changed |
| `erlmd_construct_definition` | `erlmd_cnstr_definition` | ✅ Changed |

### Inline Constructs

| Old Name | New Name | Status |
|----------|----------|--------|
| `erlmd_construct_attention` | `erlmd_cnstr_attention` | ✅ Changed |
| `erlmd_construct_autolink` | `erlmd_cnstr_autolink` | ✅ Changed |
| `erlmd_construct_character_escape` | `erlmd_cnstr_character_escape` | ✅ Changed |
| `erlmd_construct_character_reference` | `erlmd_cnstr_character_reference` | ✅ Changed |
| `erlmd_construct_code_text` | `erlmd_cnstr_code_text` | ✅ Changed |
| `erlmd_construct_hard_break_escape` | `erlmd_cnstr_hard_break_escape` | ✅ Changed |
| `erlmd_construct_html_text` | `erlmd_cnstr_html_text` | ✅ Changed |
| `erlmd_construct_label_end` | `erlmd_cnstr_label_end` | ✅ Changed |
| `erlmd_construct_label_start_link` | `erlmd_cnstr_label_start_link` | ✅ Changed |
| `erlmd_construct_label_start_image` | `erlmd_cnstr_label_start_image` | ✅ Changed |

### Partial Constructs

| Old Name | New Name | Status |
|----------|----------|--------|
| `erlmd_construct_partial_data` | `erlmd_cnstr_prtl_data` | ✅ Changed |
| `erlmd_construct_partial_space_or_tab` | `erlmd_cnstr_prtl_space_or_tab` | ✅ Changed |
| `erlmd_construct_partial_whitespace` | `erlmd_cnstr_prtl_whitespace` | ✅ Changed |
| `erlmd_construct_partial_blank_line` | *(does not exist)* | ❌ Delete |
| `erlmd_construct_partial_label` | `erlmd_cnstr_prtl_label` | ✅ Changed |
| `erlmd_construct_partial_title` | `erlmd_cnstr_prtl_title` | ✅ Changed |
| `erlmd_construct_partial_destination` | `erlmd_cnstr_prtl_destination` | ✅ Changed |
| `erlmd_construct_partial_line_ending` | `erlmd_cnstr_prtl_line_ending` | ✅ Changed |
| `erlmd_construct_partial_non_lazy_continuation` | `erlmd_cnstr_prtl_non_lazy_cont` | ✅ Changed |

### GFM Extensions

| Old Name | New Name | Status |
|----------|----------|--------|
| `erlmd_construct_gfm_table` | `erlmd_ext_gfm_table` | ✅ Changed |
| `erlmd_construct_gfm_strikethrough` | `erlmd_ext_gfm_strikethrough` | ✅ Changed |
| `erlmd_construct_gfm_autolink_literal` | `erlmd_ext_gfm_autolink_literal` | ✅ Changed |
| `erlmd_construct_gfm_task_list_item_check` | `erlmd_ext_gfm_task_list` | ✅ Changed (simplified) |
| `erlmd_construct_gfm_footnote_definition` | `erlmd_ext_gfm_footnote_definition` | ✅ Changed |
| `erlmd_construct_gfm_label_start_footnote` | `erlmd_ext_gfm_label_start_footnote` | ✅ Changed |

### Utilities

| Old Name | New Name | Status |
|----------|----------|--------|
| `erlmd_util_character_reference` | `erlmd_util_char_ref` | ✅ Changed |
| `erlmd_util_normalize_identifier` | `erlmd_util_normalize_id` | ✅ Changed |
| `erlmd_util_constant` | `erlmd_util_const` | ✅ Changed |
| `erlmd_util_char` | `erlmd_util_char` | ✔️ No change |
| `erlmd_util_sanitize_uri` | `erlmd_util_sanitize_uri` | ✔️ No change |
| `erlmd_util_encode` | `erlmd_util_encode` | ✔️ No change |

---

## Files Requiring Updates

### High Priority (Many Changes)

1. **erlmd-implementation-plan.md**
   - ~47 construct name changes
   - 2 output module name changes
   - Estimated: 50 changes

2. **erlmd-module-dependencies.md**
   - ~32 construct name changes
   - Update dependency graph
   - Estimated: 35 changes

### Medium Priority (Some Changes)

3. **007-erlmd-library-rewrite.md**
   - ~10 utility name changes
   - Update architecture diagrams
   - Estimated: 10-15 changes

4. **002-rewrite-research-erlang-markdown-implementation-patterns.md**
   - Minimal changes (mostly references)
   - Estimated: 5 changes

---

## Automated Migration Script

```bash
#!/bin/bash
# migrate-naming.sh
# Automated migration to v1.1 naming conventions

FILES="erlmd-implementation-plan.md erlmd-module-dependencies.md"

for file in $FILES; do
    echo "Processing $file..."
    
    # Output modules
    sed -i 's/erlmd_to_html/erlmd_html/g' "$file"
    sed -i 's/erlmd_to_mdast/erlmd_ast/g' "$file"
    
    # HTML constructs (special case - name change)
    sed -i 's/erlmd_construct_html_block/erlmd_cnstr_html_flow/g' "$file"
    
    # Partial constructs (do first, more specific)
    sed -i 's/erlmd_construct_partial_non_lazy_continuation/erlmd_cnstr_prtl_non_lazy_cont/g' "$file"
    sed -i 's/erlmd_construct_partial_/erlmd_cnstr_prtl_/g' "$file"
    
    # GFM extensions
    sed -i 's/erlmd_construct_gfm_task_list_item_check/erlmd_ext_gfm_task_list/g' "$file"
    sed -i 's/erlmd_construct_gfm_/erlmd_ext_gfm_/g' "$file"
    
    # Regular constructs
    sed -i 's/erlmd_construct_/erlmd_cnstr_/g' "$file"
    
    # Utilities
    sed -i 's/erlmd_util_character_reference/erlmd_util_char_ref/g' "$file"
    sed -i 's/erlmd_util_normalize_identifier/erlmd_util_normalize_id/g' "$file"
    sed -i 's/erlmd_util_constant/erlmd_util_const/g' "$file"
    
    echo "✓ Completed $file"
done

echo ""
echo "Migration complete! Please review changes with: git diff"
```

---

## Manual Review Checklist

After running automated updates, manually verify:

### ✅ Content Dispatchers
- [ ] `erlmd_cnstr_document` - ✓ Correct
- [ ] `erlmd_cnstr_flow` - ✓ Correct
- [ ] `erlmd_cnstr_text` - ✓ Correct
- [ ] `erlmd_cnstr_string` - ✓ Correct

### ✅ HTML Constructs (Name Changed!)
- [ ] No references to `erlmd_cnstr_html_block` (old)
- [ ] All use `erlmd_cnstr_html_flow` (new)
- [ ] References to `erlmd_cnstr_html_text` present

### ✅ Blank Line Classification
- [ ] `erlmd_cnstr_blank_line` (regular construct) ✓
- [ ] No references to `erlmd_cnstr_prtl_blank_line` (doesn't exist)

### ✅ Output Modules
- [ ] No references to `erlmd_to_html` (old)
- [ ] All use `erlmd_html` (new)
- [ ] No references to `erlmd_to_mdast` (old)
- [ ] All use `erlmd_ast` (new)

### ✅ Removed References
- [ ] No references to `erlmd_compiler` (removed)

### ✅ Non-Lazy Continuation
- [ ] Uses abbreviated form: `erlmd_cnstr_prtl_non_lazy_cont`

---

## Common Mistakes to Avoid

### ❌ Incorrect Patterns

```erlang
% WRONG - mixing old and new
erlmd_construct_paragraph
erlmd_cnstr_heading

% WRONG - blank_line as partial
erlmd_cnstr_prtl_blank_line

% WRONG - old output names
erlmd_to_html
erlmd_to_mdast

% WRONG - html_block instead of html_flow
erlmd_cnstr_html_block

% WRONG - full "continuation" in long names
erlmd_cnstr_prtl_non_lazy_continuation
```

### ✅ Correct Patterns

```erlang
% RIGHT - consistent cnstr prefix
erlmd_cnstr_paragraph
erlmd_cnstr_heading_atx

% RIGHT - blank_line is regular construct
erlmd_cnstr_blank_line

% RIGHT - new output names
erlmd_html
erlmd_ast

% RIGHT - html_flow matches content types
erlmd_cnstr_html_flow
erlmd_cnstr_html_text

% RIGHT - abbreviated continuation in long names
erlmd_cnstr_prtl_non_lazy_cont
```

---

## Testing After Migration

1. **Check for broken references**:
   ```bash
   # Look for any remaining old patterns
   grep -r "erlmd_construct_" docs/
   grep -r "erlmd_to_html\|erlmd_to_mdast" docs/
   grep -r "erlmd_compiler" docs/
   ```

2. **Verify consistency**:
   ```bash
   # All construct modules should use cnstr
   grep -r "erlmd_cnstr_" docs/ | wc -l
   
   # No old construct naming should remain
   grep -r "erlmd_construct_" docs/ | wc -l  # Should be 0
   ```

3. **Manual spot checks**:
   - Open each modified file
   - Search for "erlmd_" to review all module references
   - Verify against Complete Module List in naming conventions

---

## Summary

**Total Changes Needed**: ~100 instances across 4 documents

**Key Changes**:
- `erlmd_construct_*` → `erlmd_cnstr_*` (47+ instances)
- `erlmd_construct_partial_*` → `erlmd_cnstr_prtl_*` (8+ instances)  
- `erlmd_construct_gfm_*` → `erlmd_ext_gfm_*` (6+ instances)
- `erlmd_to_html` → `erlmd_html` (multiple instances)
- `erlmd_to_mdast` → `erlmd_ast` (multiple instances)
- `erlmd_cnstr_html_block` → `erlmd_cnstr_html_flow` (name change)
- Utility abbreviations (3 modules)

**Priority Order**:
1. Run automated migration script
2. Manual review for name changes (html_flow, task_list)
3. Verify no broken references
4. Test documentation generation

---

*Created: November 14, 2025*
*For: erlmd v1.1 naming conventions*
